<!--
 * @Description: å¤šè¡Œæ–‡æœ¬æœ«å°¾æ˜¾ç¤ºçœç•¥å·(å¦‚æœ‰è‹±æ–‡éœ€è¦æ·»åŠ word-break)
 * @Author: Dong Wei
 * @Date: 2020-12-25 11:11:42
 * @LastEditors: Dong Wei
 * @LastEditTime: 2020-12-28 15:08:38
 * @FilePath: \vue2x-playground\src\views\css\Ellipsis.vue
-->
<template>
  <div class="wrap">
    <p
      class="ellipsis"
      id="ellipsisBox"
    >
      {{words}}
    </p>
  </div>
</template>

<script>
// import '@/plugins/clamp';
import '@/plugins/clamp/full';
export default {
  name: 'Ellipsis',
  data() {
    return {
      wordsNum: '123456789012', // 12
      wordsLowerLetters: 'abcdefgabcdef', // 13
      wordsUpperLetters: 'ABCDEFGHIJK', // 11
      wordsChinese: 'ä»»è‘£äº‹é•¿åŠé¦–å¸­', // 7
      wordsSymbol: '!@#$%^&*()_+', // 12
      wordsSymbol2: 'ï¼ï¼ˆï¼‰â€”â€”ã€Šã€‹', // 7
      wordsJapanese: 'ã„ãã‚‚ã®ãŒã‹ã‚Š', // 7
      // words: 'å²è’‚å¤«Â·ä¹”å¸ƒæ–¯ï¼ˆè‹±è¯­ï¼šSteve Jobsï¼‰ï¼Œæ˜¯ä¸€åç¾å›½ä¼ä¸šå®¶ã€è¥é”€å®¶å’Œå‘æ˜å®¶ï¼Œè‹¹æœå…¬å¸çš„è”åˆåˆ›å§‹äººä¹‹ä¸€ï¼Œæ›¾ä»»è‘£äº‹é•¿åŠé¦–å¸­æ‰§è¡Œå®˜èŒä½ï¼ŒNeXTåˆ›åŠäººåŠé¦–å¸­æ‰§è¡Œå®˜ï¼Œä¹Ÿæ˜¯çš®å…‹æ–¯åŠ¨ç”»çš„åˆ›åŠäººå¹¶æ›¾ä»»é¦–å¸­æ‰§è¡Œå®˜ï¼Œ2006å¹´ä¸ºåç‰¹è¿ªå£«å°¼å…¬å¸çš„è‘£äº‹ä¼šæˆå‘˜ã€‚'
      words: 'å²è’‚å¤«Â·ä¹”å¸ƒæ–¯ï¼ˆè‹±è¯­ï¼šABCDEFGHIJKï¼‰ğŸ˜ğŸ˜±ï¼Œæ˜¯aaabbbdddddddsfsdfsdfsdfsdfsdfï¼Œè‹¹æœå…¬å¸çš„è”åˆåˆ›å§‹äººä¹‹ä¸€ï¼Œæ›¾ä»»è‘£äº‹é•¿åŠé¦–å¸­æ‰§è¡Œå®˜èŒä½ï¼ŒNeXTåˆ›åŠäººåŠé¦–å¸­æ‰§è¡Œå®˜ï¼Œä¹Ÿæ˜¯çš®å…‹æ–¯åŠ¨ç”»çš„åˆ›åŠäººå¹¶æ›¾ä»»é¦–å¸­æ‰§è¡Œå®˜ï¼Œ2006å¹´ä¸ºåç‰¹è¿ªå£«å°¼å…¬å¸çš„è‘£äº‹ä¼šæˆå‘˜ã€‚'
    };
  },
  mounted() {
    this.setEllipsis();
  },
  methods: {
    setEllipsis() {
      // å®ç°æ€è·¯ï¼šå¦‚æœæµè§ˆå™¨ä¸å…¼å®¹-webkit-line-clamp åˆ™ä½¿ç”¨jsæˆªå–å­—ç¬¦ä¸²ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šå­—ç¬¦åˆ™å»æ‰å­—ç¬¦ä¸²æœ€åä¸€ä½å¹¶åŠ ä¸Šçœç•¥å·åˆ¤æ–­å­—ç¬¦ä¸²é«˜åº¦æ˜¯å¦å°äºè®¾å®šé«˜åº¦(æ¯è¡Œé«˜åº¦é»˜è®¤ç­‰äºè¡Œé«˜ï¼Œå¦‚æœline-heightä¸ºnormalåˆ™ä½¿ç”¨1.2*fontSize)ï¼Œä¸å°äºåˆ™é€’å½’ç»§ç»­æˆªå–å­—ç¬¦ä¸²
      // æˆªè‡³2020å¹´åº•ï¼Œä¸»æµæµè§ˆå™¨(chrome,firefox,safari)å‡å·²å…¼å®¹-webkit-line-clampä¸-webkit-box-orient
      const box = document.getElementById('ellipsisBox');
      // eslint-disable-next-line no-undef
      $clamp(box, { clamp: 3 });
    },
    /**
     * @description: æ ¹æ®å†…å®¹å®½åº¦å’Œfontsizeè·å–çœç•¥å·ä¹‹å‰çš„å­—ç¬¦ä¸²é•¿åº¦(ç”±äºä¸çŸ¥é“è§„å®šè¡Œæ•°å†…çš„å­—æ¯æ•°é‡æ‰€ä»¥æš‚æ—¶æ— æ³•è®¡ç®—)
     * @param {Stirng} str å†…å®¹å­—ç¬¦ä¸²
     * @param {Number} lineNum éœ€è¦ä¿ç•™çš„è¡Œæ•°
     * @param {Number} width å®¹å™¨[å†…å®¹]çš„å®½åº¦
     * @param {Number} fontSize å®¹å™¨å†…æ–‡æœ¬çš„å­—ä½“å¤§å°
     * @return {*}
     */
    getStringLength(str, lineNum, width, fontSize = 14) {
      // è¿‘ä¼¼è®¡ç®—ï¼šå°å†™å­—æ¯å’Œæ•°å­—ä¸€ä¸ªå­—ç¬¦å åŠä¸ªfontsizeçš„å®½åº¦,å…¶ä»–çš„ä¸€ä¸ªå­—ç¬¦å ä¸€ä¸ªfontsizeçš„å®½åº¦
      // æŒ‰ç…§å°å†™å­—æ¯å’Œæ•°å­—ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²é•¿åº¦ï¼Œå…¶å®ƒä¸ºä¸¤ä¸ªå­—ç¬¦ä¸²é•¿åº¦æ¥è®¡ç®—
      const unitNumberPerLine = Math.floor((width / fontSize) * 2); // æ¯ä¸€è¡Œçš„æœ€å°å­—ç¬¦ä¸²é•¿åº¦(ä»¥å°å†™å­—æ¯å’Œæ•°å­—ä¸ºæœ€å°å•ä½)
      const unitNumberInNeed = unitNumberPerLine * lineNum; // å¯ä»¥å®¹çº³çš„æœ€å°å­—ç¬¦ä¸²æ€»é•¿åº¦
      const lowerStrReg = /[a-z0-9]/g; // åŒ¹é…å°å†™å­—æ¯å’Œæ•°å­—
      const lowerStrLength = str.match(lowerStrReg).length; // å°å†™å­—æ¯å’Œæ•°å­—çš„é•¿åº¦
      const otherStrLength = str.length - lowerStrLength; // å…¶ä»–å­—ç¬¦ä¸²çš„é•¿åº¦
      const strUnitLength = otherStrLength * 2 + lowerStrLength; // æŒ‰ç…§æœ€å°å•ä½è®¡ç®—å‡ºæ¥çš„å­—ç¬¦ä¸²æ‰€å æ€»é•¿åº¦
    }
  }
};
</script>
<style scoped lang="less">
.wrap{
  width: 300px;
  border: 1px solid #000;
}
.ellipsis{
  word-break: break-all;
  // overflow: hidden;
  // text-overflow: ellipsis;
  // display: -webkit-box;
  // -webkit-line-clamp: 3;
  // -webkit-box-orient: vertical;
}
</style>